<dfy-header></dfy-header>
<main class="main-content">
  <div class="content">
    <div class="challenge-preview">
      <div class="challenge-preview-banner" [ngStyle]="{'background-image': 'url('+ bannerUrl +')'}">
        <div class="challenge-preview-icon">
          <img [src]="iconUrl" alt="">
        </div>
      </div>
      <div class="challenge-preview-info">
        <div class="challenge-preview-info-short">
          <p class="challenge-preview-info-short-title">{{challenge.title}}</p>
          <div class="challenge-preview-info-short-author">
            <img [src]="authorAvatarUrl" alt="">
            <p>By <span class="challenge-preview-info-short-author-username">{{challenge.author.username}}</span></p>
          </div>
        </div>
        <div class="challenge-preview-info-state">
          <div class="challenge-preview-info-state-access">
            <svg width="32" height="32" viewBox="0 0 24 24" *ngIf="hasAccess('FREE') ||!challenge.config">
              <path
                d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10s10-4.48 10-10S17.52 2 12 2zm-1 17.93c-3.95-.49-7-3.85-7-7.93c0-.62.08-1.21.21-1.79L9 15v1c0 1.1.9 2 2 2v1.93zm6.9-2.54c-.26-.81-1-1.39-1.9-1.39h-1v-3c0-.55-.45-1-1-1H8v-2h2c.55 0 1-.45 1-1V7h2c1.1 0 2-.9 2-2v-.41c2.93 1.19 5 4.06 5 7.41c0 2.08-.8 3.97-2.1 5.39z"/>
            </svg>
            <svg width="32" height="32" viewBox="0 0 24 24" *ngIf="hasAccess('CODE')">
              <path
                d="M18 8h-1V6c0-2.76-2.24-5-5-5S7 3.24 7 6v2H6c-1.1 0-2 .9-2 2v10c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V10c0-1.1-.9-2-2-2zM9 6c0-1.66 1.34-3 3-3s3 1.34 3 3v2H9V6zm9 14H6V10h12v10zm-6-3c1.1 0 2-.9 2-2s-.9-2-2-2s-2 .9-2 2s.9 2 2 2z"/>
            </svg>
            <svg width="32" height="32" viewBox="0 0 256 256" *ngIf="hasAccess('FRIENDS_ONLY')">
              <path
                d="M128 24a104 104 0 1 0 104 104A104.2 104.2 0 0 0 128 24Zm0 192a88 88 0 1 1 88-88a88.1 88.1 0 0 1-88 88ZM80 108a12 12 0 1 1 12 12a12 12 0 0 1-12-12Zm72 0a12 12 0 1 1 12 12a12 12 0 0 1-12-12Zm24.5 48a56 56 0 0 1-97 0a8 8 0 1 1 13.8-8a40.1 40.1 0 0 0 69.4 0a8 8 0 0 1 13.8 8Z"/>
              <
            </svg>
            <svg width="32" height="32" viewBox="0 0 24 24" *ngIf="hasAccess('ON_REQUEST')">
              <path
                d="m3.4 20.4l17.45-7.48a1 1 0 0 0 0-1.84L3.4 3.6a.993.993 0 0 0-1.39.91L2 9.12c0 .5.37.93.87.99L17 12L2.87 13.88c-.5.07-.87.5-.87 1l.01 4.61c0 .71.73 1.2 1.39.91z"/>
            </svg>
          </div>
        </div>
      </div>
    </div>
    <nav class="challenge-sections">
      <ul>
        <li [ngClass]="isOnSection(0) ? 'challenge-sections-selected' : ''" (click)="onOverview()">
          <span class="challenge-sections-name">Overview</span>
          <svg width="32" height="32" viewBox="0 0 24 24">
            <path fill="none" stroke-width="1.5"
                  d="M3 9.4V3.6a.6.6 0 0 1 .6-.6h16.8a.6.6 0 0 1 .6.6v5.8a.6.6 0 0 1-.6.6H3.6a.6.6 0 0 1-.6-.6Zm11 11v-5.8a.6.6 0 0 1 .6-.6h5.8a.6.6 0 0 1 .6.6v5.8a.6.6 0 0 1-.6.6h-5.8a.6.6 0 0 1-.6-.6Zm-11 0v-5.8a.6.6 0 0 1 .6-.6h5.8a.6.6 0 0 1 .6.6v5.8a.6.6 0 0 1-.6.6H3.6a.6.6 0 0 1-.6-.6Z"/>
          </svg>
        </li>
        <li [ngClass]="isOnSection(1) ? 'challenge-sections-selected' : ''" (click)="onChats()">
          <span class="challenge-sections-name">Chats</span>
          <svg width="32" height="32" viewBox="0 0 24 24">
            <g fill="none" stroke-width="1.5">
              <path stroke-linecap="round" stroke-linejoin="round" d="M7 12h10M7 8h6"/>
              <path
                d="M3 20.29V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2H7.961a2 2 0 0 0-1.561.75l-2.331 2.914A.6.6 0 0 1 3 20.29Z"/>
            </g>
          </svg>
        </li>
        <li [ngClass]="isOnSection(2) ? 'challenge-sections-selected' : ''" (click)="onGroups()">
          <span class="challenge-sections-name">Groups</span>
          <svg width="32" height="32" viewBox="0 0 24 24">
            <g fill="none" stroke-linecap="round" stroke-width="1.5">
              <path d="M1 20v-1a7 7 0 0 1 7-7v0a7 7 0 0 1 7 7v1"/>
              <path d="M13 14v0a5 5 0 0 1 5-5v0a5 5 0 0 1 5 5v.5"/>
              <path stroke-linejoin="round" d="M8 12a4 4 0 1 0 0-8a4 4 0 0 0 0 8Zm10-3a3 3 0 1 0 0-6a3 3 0 0 0 0 6Z"/>
            </g>
          </svg>
        </li>
        <li [ngClass]="isOnSection(3) ? 'challenge-sections-selected' : ''" (click)="onLeaderboard()">
          <span class="challenge-sections-name">Leaderboard</span>
          <svg width="32" height="32" viewBox="0 0 24 24">
            <path fill="none" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5"
                  d="M15 21H9v-8.4a.6.6 0 0 1 .6-.6h4.8a.6.6 0 0 1 .6.6V21Zm5.4 0H15v-2.9a.6.6 0 0 1 .6-.6h4.8a.6.6 0 0 1 .6.6v2.3a.6.6 0 0 1-.6.6ZM9 21v-4.9a.6.6 0 0 0-.6-.6H3.6a.6.6 0 0 0-.6.6v4.3a.6.6 0 0 0 .6.6H9Zm1.806-15.887l.909-1.927a.312.312 0 0 1 .57 0l.91 1.927l2.032.311c.261.04.365.376.176.568l-1.47 1.5l.347 2.118c.044.272-.228.48-.462.351l-1.818-1l-1.818 1c-.233.128-.506-.079-.462-.351l.347-2.118l-1.47-1.5c-.19-.192-.085-.528.175-.568l2.034-.31Z"/>
          </svg>
        </li>
        <li [ngClass]="isOnSection(4) ? 'challenge-sections-selected' : ''" (click)="onSettings()">
          <span class="challenge-sections-name">Settings</span>
          <svg width="32" height="32" viewBox="0 0 24 24">
            <g fill="none" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5">
              <path d="M12 15a3 3 0 1 0 0-6a3 3 0 0 0 0 6Z"/>
              <path
                d="m19.622 10.395l-1.097-2.65L20 6l-2-2l-1.735 1.483l-2.707-1.113L12.935 2h-1.954l-.632 2.401l-2.645 1.115L6 4L4 6l1.453 1.789l-1.08 2.657L2 11v2l2.401.655L5.516 16.3L4 18l2 2l1.791-1.46l2.606 1.072L11 22h2l.604-2.387l2.651-1.098C16.697 18.831 18 20 18 20l2-2l-1.484-1.75l1.098-2.652l2.386-.62V11l-2.378-.605Z"/>
            </g>
          </svg>
        </li>
      </ul>
    </nav>
    <div #challenge_box class="challenge-box">
      <div class="challenge-box-chats" *ngIf="isOnSection(1)">
        <h1>Chats</h1>
        <div>
          <ul class="challenge-box-chats-list">
            <li *ngFor="let channel of channels" (click)="setCurrentChannel(channel)">{{channel.name}}</li>
          </ul>
          <div class="chat-box">
            <div class="chat-box-messages" #messages_box>
              <div class="chat-box-messages-item" [ngClass]="{'current-member-message': isSelfMember(message.sender)}" *ngFor="let message of messages">
                <div class="sender-avatar" *ngIf="!isSelfMember(message.sender)">
                  <img [src]="message.sender.profile.avatarUrl" alt="">
                  <div class="sender-avatar-status">
                    <span class="status-indicator" [ngClass]="message.sender.profile.online ? 'status-indicator-online' : 'status-indicator-offline'"></span>
                  </div>
                </div>
                <div>
                  <div class="message-head" >
                    <a class="sender-username" [routerLink]="['/app/user/', message.sender.profile.username]">{{message.sender.profile.username}}</a>
                    <p class="timestamp">{{message.sent_at}}</p>
                  </div>
                  <p class="message-content">{{message.content}}</p>
                </div>
                <div class="sender-avatar" *ngIf="isSelfMember(message.sender)">
                  <img [src]="message.sender.profile.avatarUrl" alt="">
                  <div class="sender-avatar-status">
                    <span class="status-indicator" [ngClass]="message.sender.profile.online ? 'status-indicator-online' : 'status-indicator-offline'"></span>
                  </div>
                </div>
              </div>
            </div>
            <div class="user-input send-message">
              <div class="user-input-box">
                <label for="message">Send message</label>
                <input id="message" class="form-control" type="text" name="message" #text_input>
                <button class="submit-btn" type="submit" value="">
                  <svg width="32" height="32" viewBox="0 0 24 24">
                    <path
                            d="m3.4 20.4l17.45-7.48a1 1 0 0 0 0-1.84L3.4 3.6a.993.993 0 0 0-1.39.91L2 9.12c0 .5.37.93.87.99L17 12L2.87 13.88c-.5.07-.87.5-.87 1l.01 4.61c0 .71.73 1.2 1.39.91z"/>
                  </svg>
                </button>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="challenge-box-groups" *ngIf="isOnSection(2)">
        <h1>Groups / Members</h1>
        <div class="challenge-box-groups-list">
          <div class="groups-list-item groups-list-item-new">
            <svg width="32" height="32" viewBox="0 0 24 24">
              <path
                d="M22 9V8c0-.55-.45-1-1-1s-1 .45-1 1v1h-1c-.55 0-1 .45-1 1s.45 1 1 1h1v1c0 .55.45 1 1 1s1-.45 1-1v-1h1c.55 0 1-.45 1-1s-.45-1-1-1h-1zM8 12c2.21 0 4-1.79 4-4s-1.79-4-4-4s-4 1.79-4 4s1.79 4 4 4zm0 1c-2.67 0-8 1.34-8 4v3h16v-3c0-2.66-5.33-4-8-4zm4.51-8.95C13.43 5.11 14 6.49 14 8s-.57 2.89-1.49 3.95C14.47 11.7 16 10.04 16 8s-1.53-3.7-3.49-3.95zm4.02 9.78C17.42 14.66 18 15.7 18 17v3h2v-3c0-1.45-1.59-2.51-3.47-3.17z"/>
            </svg>
            <p>New Group</p>
          </div>
          <div class="groups-list-item" *ngFor="let group of groups">
            <img class="groups-list-item-icon" [src]="getGroupIcon(group)" alt="">
            <p class="groups-list-item-name">{{group.name}}</p>
            <div class="groups-list-item-members-count">
              <svg width="32" height="32" viewBox="0 0 256 256">
                <path
                  d="M247.6 144.8a6 6 0 0 1-8.4-1.2A53.7 53.7 0 0 0 196 122a6 6 0 0 1 0-12a26 26 0 1 0-25.5-30.9a6.1 6.1 0 0 1-7.1 4.8a5.9 5.9 0 0 1-4.7-7A38 38 0 0 1 234 84a37.6 37.6 0 0 1-14.9 30.1a66.4 66.4 0 0 1 29.7 22.3a6 6 0 0 1-1.2 8.4ZM191 213.4a6.1 6.1 0 0 1-2.8 8a6.2 6.2 0 0 1-2.6.6a5.8 5.8 0 0 1-5.4-3.4a58.1 58.1 0 0 0-104.4 0a6 6 0 0 1-8 2.8a6.1 6.1 0 0 1-2.8-8a69.9 69.9 0 0 1 38-34.8a46 46 0 1 1 50 0a69.9 69.9 0 0 1 38 34.8ZM128 174a34 34 0 1 0-34-34a34.1 34.1 0 0 0 34 34Zm-68-64a26 26 0 1 1 25.5-30.9a6.1 6.1 0 0 0 7.1 4.8a5.9 5.9 0 0 0 4.7-7A38 38 0 0 0 22 84a37.6 37.6 0 0 0 14.9 30.1a66.4 66.4 0 0 0-29.7 22.3a6 6 0 1 0 9.6 7.2A53.7 53.7 0 0 1 60 122a6 6 0 0 0 0-12Z"/>
              </svg>
              <p>15 / 24</p>
            </div>
            <button class="groups-list-item-join-btn">Join</button>
          </div>
        </div>
      </div>
    </div>
  </div>
</main>
<dfy-footer></dfy-footer>
